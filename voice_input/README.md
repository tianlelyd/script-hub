# 讯飞语音助手

一个仿讯飞语音输入法交互体验的全局语音输入工具（非输入法形态），按下指定快捷键即可开始录音，再次按下结束并自动把识别结果粘贴到当前焦点。基于 Python、sounddevice 采集音频，调用讯飞语音开放平台实时语音听写 WebAPI。

## 环境准备

1. Python 3.9+（macOS 自带 Python 3 通常版本较老，建议使用 `pyenv` 或 `brew` 安装）。
2. 安装依赖：

```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

3. 在项目根目录 `.env` 填写讯飞密钥（已存在示例字段 `APPID`、`APIKey`、`APISecret`）。
4. 第一次运行前，请到「系统设置 → 隐私与安全性」中授予：
   - **麦克风**：允许 `python`（或终端 App）访问麦克风；
   - **辅助功能**：允许控制键盘以便模拟 `Cmd+V` 粘贴。

## 使用方式

```bash
python3 -m src.voice_input.app
```

- 默认快捷键为 `⌥ + 空格`，首次按下开始录音，再按一次结束并触发识别。
- 识别完成后会自动复制文本并粘贴到当前输入焦点，同时恢复原剪贴板内容。
- 日志会在终端输出，便于排查问题。

## 常见问题

- **没有声音 / 录音失败**：确认麦克风权限已授权；若仍失败，可在终端运行时关注日志中的警告信息。
- **快捷键无效**：macOS 可能需要在辅助功能权限里勾选当前终端；若想修改快捷键，可在 `VoiceInputApp` 初始化时调整组合。
- **识别报错**：日志中会显示讯飞返回的错误码，请核对账号是否可用、是否超出调用限制等。

## TODO & 可选增强

- 增加静音检测，免去再次按键结束。
- 加托盘或菜单栏小图标提示当前录音状态。
- 提供 GUI 配置界面与更多自定义选项。
